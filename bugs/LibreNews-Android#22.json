{
    "apk_name": "LibreNews-Android_v1.4.apk",
    "url": "https://github.com/milesmcc/LibreNews-Android/issues/22",
    "repo": "LibreNews-Android",
    "title": "java.lang.ArrayIndexOutOfBoundsException",
    "body": "Reproduced in Android Studio Emulator and Android Nexus 5 Phone (6.0.1)\r\n\r\nSteps:\r\n\r\n1. Install v1.4 from FDroid.\r\n2. Launch app.\r\n3. Disable `automatically refresh`\r\n4. Change server address to an invalid one, e.g., `xxyyzz`.\r\n5. Click `refresh`.\r\n\r\nSolution:\r\nAt FlashManager.java#L184, `min` may be 0 and the array may be empty.\r\nHence, we need to handle this case explicitly.\r\n\r\n[FlashManager.java#L184](https://github.com/milesmcc/LibreNews-Android/blob/974b9592fa6c4ef591f5efccc4e85468c3650684/LibreNews-App/src/main/java/app/librenews/io/librenews/controllers/FlashManager.java#L184)\r\n\r\n-------------------------------\r\nStack traces\r\n```\r\n11-01 14:56:58.359 12058 12058 I System.out: LibreNews Debug: Unable to load flashes from storage: No flash storage file exists or is empty.\r\n11-01 14:56:58.360 12058 12058 W System.err: java.io.FileNotFoundException: No flash storage file exists or is empty.\r\n11-01 14:56:58.360 12058 12058 W System.err:    at app.librenews.io.librenews.controllers.FlashManager.loadFlashesFromStorage(FlashManager.java:140)\r\n11-01 14:56:58.360 12058 12058 W System.err:    at app.librenews.io.librenews.controllers.FlashManager.getLatestPushedFlashes(FlashManager.java:191)\r\n11-01 14:56:58.360 12058 12058 W System.err:    at app.librenews.io.librenews.controllers.FlashManager.refresh(FlashManager.java:251)\r\n11-01 14:56:58.360 12058 12058 W System.err:    at app.librenews.io.librenews.views.MainFlashActivity$1.onClick(MainFlashActivity.java:67)\r\n11-01 14:56:58.360 12058 12058 W System.err:    at android.view.View.performClick(View.java:5204)\r\n11-01 14:56:58.360 12058 12058 W System.err:    at android.view.View$PerformClick.run(View.java:21153)\r\n11-01 14:56:58.360 12058 12058 W System.err:    at android.os.Handler.handleCallback(Handler.java:739)\r\n11-01 14:56:58.360 12058 12058 W System.err:    at android.os.Handler.dispatchMessage(Handler.java:95)\r\n11-01 14:56:58.360 12058 12058 W System.err:    at android.os.Looper.loop(Looper.java:148)\r\n11-01 14:56:58.360 12058 12058 W System.err:    at android.app.ActivityThread.main(ActivityThread.java:5417)\r\n11-01 14:56:58.360 12058 12058 W System.err:    at java.lang.reflect.Method.invoke(Native Method)\r\n11-01 14:56:58.360 12058 12058 W System.err:    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:726)\r\n11-01 14:56:58.360 12058 12058 W System.err:    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)\r\n```\r\n\r\n```\r\n// CRASH: app.librenews.io.librenews (pid 3182) (elapsed nanos: 493838390542)\r\n// Short Msg: java.lang.ArrayIndexOutOfBoundsException\r\n// Long Msg: java.lang.ArrayIndexOutOfBoundsException: length=0; index=0\r\n// Build Label: Android/sdk_google_phone_x86/generic_x86:6.0/MASTER/4088240:userdebug/test-keys\r\n// Build Changelist: 4088240\r\n// Build Time: 1497047463000\r\n// java.lang.ArrayIndexOutOfBoundsException: length=0; index=0\r\n// \tat app.librenews.io.librenews.controllers.FlashManager.convertFlashesToOutputString(FlashManager.java:184)\r\n// \tat app.librenews.io.librenews.controllers.FlashManager.writeFlashesToStorage(FlashManager.java:152)\r\n// \tat app.librenews.io.librenews.controllers.FlashManager.clearPushedFlashes(FlashManager.java:200)\r\n// \tat app.librenews.io.librenews.controllers.FlashManager.refresh(FlashManager.java:256)\r\n// \tat app.librenews.io.librenews.views.MainFlashActivity$1.onClick(MainFlashActivity.java:67)\r\n// \tat android.view.View.performClick(View.java:5198)\r\n// \tat android.view.View$PerformClick.run(View.java:21147)\r\n// \tat android.os.Handler.handleCallback(Handler.java:739)\r\n// \tat android.os.Handler.dispatchMessage(Handler.java:95)\r\n// \tat android.os.Looper.loop(Looper.java:148)\r\n// \tat android.app.ActivityThread.main(ActivityThread.java:5417)\r\n// \tat java.lang.reflect.Method.invoke(Native Method)\r\n// \tat com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:726)\r\n// \tat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)\r\n// \r\n```",
    "comments": [
        "I think one possible solution of this is just deleting the three line, [FlashManager.java#L180](https://github.com/milesmcc/LibreNews-Android/blob/974b9592fa6c4ef591f5efccc4e85468c3650684/LibreNews-App/src/main/java/app/librenews/io/librenews/controllers/FlashManager.java#L180) to [FlashManager.java#L182](https://github.com/milesmcc/LibreNews-Android/blob/974b9592fa6c4ef591f5efccc4e85468c3650684/LibreNews-App/src/main/java/app/librenews/io/librenews/controllers/FlashManager.java#L182), that will prevent program running to the following loop in line 183."
    ]
}