{
    "apk_name": "NotallyX_v7.4.0.apk",
    "url": "https://github.com/PhilKes/NotallyX/issues/569",
    "repo": "NotallyX",
    "title": "App crashes when editing checked ListItem text",
    "body": "### What happened?\n\n**Bug Description**\nThe app crashes when editing a list item in a checklist-style note. The crash is caused by an `IndexOutOfBoundsException` during text change handling, likely due to improper access to an empty list.\n\n**To Reproduce**\nSteps to reproduce the behavior:\n\n1. Tap on \"Add List Note\".\n2. Add a list item for the new note.\n3. Mark the list item as completed.\n4. Tap the list item text to enter edit mode.\n5. Enter any text â€” the app crashes immediately.\n\n**Expected Behavior**\nEditing a list item should be handled safely. No crash should occur during typing.\n\n**Screen Recording**\nhttps://github.com/user-attachments/assets/5b2f3d12-fe9c-4ecb-b71c-f9a517a25c4d\n\n**Smartphone:**\n* Device: generic\\_x86\\_64 (Android Studio x86 emulator)\n* OS: Android 9.0 (Default Android System Image)\n* Version: 7.4.0\n\n### App Version\n\n7.4.0\n\n### Android Version (API Level)\n\nAndroid 9.0 (API 28)\n\n### (Optional) Relevant log output\n\n```shell\nException dispatching input event.  (InputEventReceiver)\nException in MessageQueue callback: handleReceiveCallback  (MessageQueue-JNI)\njava.lang.IndexOutOfBoundsException: Index: 0, Size: 0  (MessageQueue-JNI)\nat java.util.ArrayList.get(ArrayList.java:437)  (MessageQueue-JNI)\nat com.philkes.notallyx.presentation.UiExtensionsKt$createListTextWatcherWithHistory$1.afterTextChanged(SourceFile:62)  (MessageQueue-JNI)\nat android.widget.TextView.sendAfterTextChanged(TextView.java:9770)  (MessageQueue-JNI)\nat android.widget.TextView$ChangeWatcher.afterTextChanged(TextView.java:12522)  (MessageQueue-JNI)\nat android.text.SpannableStringBuilder.sendAfterTextChanged(SpannableStringBuilder.java:1273)  (MessageQueue-JNI)\nat android.text.SpannableStringBuilder.replace(SpannableStringBuilder.java:576)  (MessageQueue-JNI)\nat androidx.emoji2.text.SpannableBuilder.replace(SourceFile:7)  (MessageQueue-JNI)\nat android.text.SpannableStringBuilder.delete(SpannableStringBuilder.java:229)  (MessageQueue-JNI)\nat androidx.emoji2.text.SpannableBuilder.delete(SourceFile:1)  (MessageQueue-JNI)\nat android.text.method.BaseKeyListener.deleteSelection(BaseKeyListener.java:433)  (MessageQueue-JNI)\nat android.text.method.BaseKeyListener.backspaceOrForwardDelete(BaseKeyListener.java:328)  (MessageQueue-JNI)\nat android.text.method.BaseKeyListener.backspace(BaseKeyListener.java:71)  (MessageQueue-JNI)\nat android.text.method.BaseKeyListener.onKeyDown(BaseKeyListener.java:479)  (MessageQueue-JNI)\nat android.text.method.QwertyKeyListener.onKeyDown(QwertyKeyListener.java:362)  (MessageQueue-JNI)\nat android.text.method.TextKeyListener.onKeyDown(TextKeyListener.java:141)  (MessageQueue-JNI)\nat androidx.emoji2.viewsintegration.EmojiKeyListener.onKeyDown(SourceFile:39)  (MessageQueue-JNI)\nat android.widget.TextView.doKeyDown(TextView.java:7665)  (MessageQueue-JNI)\nat android.widget.TextView.onKeyDown(TextView.java:7442)  (MessageQueue-JNI)\nat android.view.KeyEvent.dispatch(KeyEvent.java:2692)  (MessageQueue-JNI)\nat android.view.View.dispatchKeyEvent(View.java:12450)  (MessageQueue-JNI)\nat android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1896)  (MessageQueue-JNI)\nat android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1896)  (MessageQueue-JNI)\nat android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1896)  (MessageQueue-JNI)\nat android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1896)  (MessageQueue-JNI)\nat android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1896)  (MessageQueue-JNI)\nat android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1896)  (MessageQueue-JNI)\nat androidx.core.widget.NestedScrollView.dispatchKeyEvent(SourceFile:1)  (MessageQueue-JNI)\nat android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1896)  (MessageQueue-JNI)\nat android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1896)  (MessageQueue-JNI)\nat android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1896)  (MessageQueue-JNI)\nat android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1896)  (MessageQueue-JNI)\nat android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1896)  (MessageQueue-JNI)\nat android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1896)  (MessageQueue-JNI)\nat android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1896)  (MessageQueue-JNI)\nat com.android.internal.policy.DecorView.superDispatchKeyEvent(DecorView.java:428)  (MessageQueue-JNI)\nat com.android.internal.policy.PhoneWindow.superDispatchKeyEvent(PhoneWindow.java:1820)  (MessageQueue-JNI)\nat android.app.Activity.dispatchKeyEvent(Activity.java:3360)  (MessageQueue-JNI)\nat androidx.core.app.ComponentActivity.superDispatchKeyEvent(SourceFile:6)  (MessageQueue-JNI)\nat androidx.core.view.ViewKt.dispatchKeyEvent(SourceFile:12)  (MessageQueue-JNI)\nat androidx.core.app.ComponentActivity.dispatchKeyEvent(SourceFile:27)  (MessageQueue-JNI)\nat androidx.appcompat.app.AppCompatActivity.dispatchKeyEvent(SourceFile:23)  (MessageQueue-JNI)\nat androidx.appcompat.app.AppCompatDelegateImpl$AppCompatWindowCallback.dispatchKeyEvent(SourceFile:20)  (MessageQueue-JNI)\nat com.android.internal.policy.DecorView.dispatchKeyEvent(DecorView.java:342)  (MessageQueue-JNI)\nat android.view.ViewRootImpl$ViewPostImeInputStage.processKeyEvent(ViewRootImpl.java:5037)  (MessageQueue-JNI)\nat android.view.ViewRootImpl$ViewPostImeInputStage.onProcess(ViewRootImpl.java:4905)  (MessageQueue-JNI)\nat android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4426)  (MessageQueue-JNI)\nat android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4479)  (MessageQueue-JNI)\nat android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4445)  (MessageQueue-JNI)\nat android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:4585)  (MessageQueue-JNI)\nat android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:4453)  (MessageQueue-JNI)\nat android.view.ViewRootImpl$AsyncInputStage.apply(ViewRootImpl.java:4642)  (MessageQueue-JNI)\nat android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4426)  (MessageQueue-JNI)\nat android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4479)  (MessageQueue-JNI)\nat android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4445)  (MessageQueue-JNI)\nat android.view.ViewRootIm  (MessageQueue-JNI)\nFATAL EXCEPTION: main  (AndroidRuntime)\nProcess: com.philkes.notallyx, PID: 2998  (AndroidRuntime)\njava.lang.IndexOutOfBoundsException: Index: 0, Size: 0  (AndroidRuntime)\nat java.util.ArrayList.get(ArrayList.java:437)  (AndroidRuntime)\n...\n```",
    "comments": [
        "Actually the bug is that you shouldnt be able to edit checked items in the first place, this is a bug introduced in https://github.com/PhilKes/NotallyX/pull/470"
    ]
}